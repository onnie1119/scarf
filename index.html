<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é€²åº¦è¿½è¹¤</title>
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }
body.no-scroll {
  overflow: hidden;
  position: fixed;
  width: 100%;
}
    body.done-page {
      background: #e6e6e6; /* âœ… æ·±ç°å®ŒæˆèƒŒæ™¯ */
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #3a7afe;
      color: #fff;
      padding: 15px 16px;
      font-size: 16px;
    }

    .page-indicator {
      letter-spacing: 1.5px;
	  margin: 0 auto;
    }

    .reset-btn {
     	position: fixed;
		right: 20px;
		background: #3a7afe;
		border: none;
		border-radius: 4px;
		padding: 0;
		font-size: 18px;
		cursor: pointer;
		white-space: nowrap;
		flex-shrink: 0;
    }

    .reset-btn:hover {
      background: #e0eaff;
    }

    .progress-bar {
      height: 6px;
      background: #ffffff80;
      width: 100%;
    }

    .progress-fill {
      height: 100%;
      background: #bcdfff;
      width: 0%;
      transition: width 0.4s ease;
    }

    .container {
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
		overflow: visible;
z-index: auto;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr); /* âœ… å›ºå®šæ¯è¡Œ 4 æ ¼ */
      gap: 12px;
      margin-bottom: 30px;
		overflow: visible;
z-index: auto;
    }

    .cell {
    aspect-ratio: 1 / 1;
    background: #eee;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(17px, 2.5vw, 18px);
    white-space: nowrap;
    overflow: hidden;
    border-radius: 6px;
    user-select: none;
	padding: 20px;
    height: 65px;
    color: #a6a6a6;
    cursor: pointer;
    transition: background 0.3s 
ease, color 0.3s 
ease;
    position: relative;
    text-align: center;
    }

    .cell.done {
      background: #3a7afe;
      color: #fff;
    }

    .cell.active::after {
      content: "é€²è¡Œä¸­";
    position: absolute;
    bottom: 10px;
    right: 33px;
    font-size: 12px;
    color: #3a7afe;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      position: fixed;
    bottom: 2rem;
    }

    button {
      padding: 8px 20px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    #prevBtn,
    #nextBtn {
      background: #a6a6a6;
      color: #fff;
    }

    #undoBtn {
      background: #e53935;
      color: #fff;
    }

    #saveBtn {
      background: #f5b51d;
      color: #fff;
    }

    #saveBtn.saved {
      background: #4caf50;
    }
	
	#nextBtn {
  transition: background 0.3s ease, color 0.3s ease;position: relative;
}

#nextBtn:disabled {
  background: #f0f0f0;
  color: #b0b0b0;
  cursor: not-allowed;
  opacity: 1;
}

#nextBtn[aria-disabled="true"]::after {
  content: attr(title); /* âœ… é¡¯ç¤ºæç¤ºæ–‡å­— */
  position: absolute;
  top: -28px;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: #fff;
  padding: 4px 8px;
  font-size: 12px;
  border-radius: 4px;
  white-space: nowrap;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}
#nextBtn.completed {
  background: #3a7afe;
  color: #fff;
  cursor: default;
  border: none;
}
#prevBtn[disabled] {
  background: #f0f0f0;
  color: #b0b0b0;
  cursor: not-allowed;
  border: 1px solid #ccc;
}
.cell.done {
  background: #3a7afe;
  color: #fff;
  font-size: 12px;
  letter-spacing: 1px;
}
#grid {
  	display: grid;
    grid-template-columns: repeat(3, 1fr);
    max-width: 100%;
    box-sizing: border-box;
    justify-items: center;
}
.cell {
  aspect-ratio: 1 / 1; /* âœ… ä¿æŒæ­£æ–¹å½¢ */
  background: #eee;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(16px, 2.5vw, 18px); /* âœ… è‡ªå‹•ç¸®æ”¾ */
  white-space: nowrap; /* âœ… ä¸æ›è¡Œ */
  overflow: hidden;
  border-radius: 6px;
  user-select: none;
}
.cell.done {
  background: #3a7afe;
  color: #fff;
  font-weight: 500;
  letter-spacing: 0.5px;
}
#container {
  max-width: 600px;
  margin: 0 auto;
}
#topBar {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  padding: 8px 16px;
  background: #f5f5f5;
}

#guideBtn {
    position: fixed;
	font-size: 18px;
    right: 45px;
	background-color:#3a7afe;
    border: none;
    padding: 0;
    border-radius: 4px;
    cursor: pointer;
}

#guideOverlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

#guideOverlay.hidden {
  display: none;
}

#guideContainer {
    
    border-radius: 8px;
    position: relative;
    width: 95%;
    height: 80%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

#guideImage {
  max-width: 100%;
  max-height: 100%;
}

.guideNav button {
     background-color: white;
    padding: 6px 0px;
    font-size: 20px;
    cursor: pointer;
}
.guideNew{
	    position: absolute;
    bottom: 10px;
}
#closeGuide {
   position: absolute;
    top: 11px;
    right: 0px;
    background: transparent;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #333;
}
@keyframes pulse {
  0% { box-shadow: 0 0 0px rgba(58, 122, 254, 0.2); }
  50% { box-shadow: 0 0 12px rgba(58, 122, 254, 0.3); }
  100% { box-shadow: 0 0 0px rgba(58, 122, 254, 0.2); }
}
.cell.active {
  animation: pulse 1.5s infinite;
	background: #FFF;
  border: 1px solid #e0eaff;
}

#authScreen {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #f9f9f9;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.auth-box {
  
  text-align: center;
}

.auth-box input {
 padding: 14px 20px;
    font-size: 14px;
    margin-bottom: 12px;
    border: 1px solid #e1e1e1;
    border-radius: 50px;
    width: 230px;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.auth-box button {
 padding: 6px 18px;
    background: #3a7afe;
    color: #fff;
    border: none;
    margin-top: 1rem;
    border-radius: 50px;
    cursor: pointer;
}

#toggleAuth {
  font-size: 14px;
  color: #3a7afe;
  cursor: pointer;
  margin-top: 10px;
}

.user-info {
  position: fixed;
    left: 22px;
    font-size: 12px;
    color: #ffffff91;
    cursor: pointer;
	 z-index: 9999; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
}

.user-menu {
 position: absolute;
    top: 24px;
    left: -3px;
    background: #fff;
    color: #333;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 13px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    z-index: 9999;
    min-width: 77px;
}

.user-menu div {
  padding: 8px 12px;
  border-bottom: 1px solid #eee;
}

.user-menu div:last-child {
  border-bottom: none;
}

.user-menu div:hover {
  background: #f0f0f0;
}

.hidden {
  display: none;
}
.auth-buttons {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 12px;
}

.auth-buttons button {
     padding: 5px 16px;
    background: #3a7afe;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
}
/* æ·¡å‡ºå‹•ç•« */
.fade-out {
  animation: fadeOut 0.6s forwards;
}

@keyframes fadeOut {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.95); }
}

/* æ·¡å…¥å‹•ç•« */
.fade-in {
  animation: fadeIn 0.6s forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(1.05); }
  to { opacity: 1; transform: scale(1); }
}

/* é é¢æ»‘å‡º */
.page-slide-out-left {
  animation: slideOutLeft 0.6s forwards;
}
.page-slide-out-right {
  animation: slideOutRight 0.6s forwards;
}

@keyframes slideOutLeft {
  from { opacity: 1; transform: translateX(0); }
  to { opacity: 0; transform: translateX(-100%); }
}
@keyframes slideOutRight {
  from { opacity: 1; transform: translateX(0); }
  to { opacity: 0; transform: translateX(100%); }
}

/* é é¢æ»‘å…¥ */
.page-slide-in-left {
  animation: slideInLeft 0.6s forwards;
}
.page-slide-in-right {
  animation: slideInRight 0.6s forwards;
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-100%); }
  to { opacity: 1; transform: translateX(0); }
}
@keyframes slideInRight {
  from { opacity: 0; transform: translateX(100%); }
  to { opacity: 1; transform: translateX(0); }
}
.container {
  opacity: 1;
  transition: opacity 0.3s ease;
}

  </style>
</head>
<body class="no-scroll">

<div id="authScreen">
  <div class="auth-box">
    <h2 id="authTitle">ã‚¹ã‚«ãƒ¼ãƒ•ä½œã‚Š</h2>
    <input type="text" id="authUsername" placeholder="ä½¿ç”¨è€…å¸³è™Ÿ" />
    <input type="password" id="authPassword" placeholder="ä½¿ç”¨è€…å¯†ç¢¼" />
    <div class="auth-buttons">
	  <button onclick="submitAuth('login')">ç™»å…¥</button>
	  <button onclick="submitAuth('register')" style="background-color:#b0b0b0;">è¨»å†Š</button>
	</div>

  </div>
</div>

	
  <div class="top-bar">
	  
	<div class="user-info" id="userInfo">
	  <span id="displayName">ä½¿ç”¨è€…</span>
	  <div class="user-menu hidden" id="userMenu">
	    <div onclick="renameDisplayName()">ä¿®æ”¹åç¨±</div>
	    <div onclick="deleteAccount()">è¨»éŠ·å¸³è™Ÿ</div>
		<div onclick="logout()">ç™»å‡ºå¸³è™Ÿ</div>
	  </div>
	</div>

  	<button id="guideBtn">ğŸŸ¡</button>
    <div class="page-indicator" id="pageLabel">1-30</div>
    <button class="reset-btn" onclick="resetAll()">ğŸ”´</button>
  </div>
  
  <div id="guideOverlay" class="hidden">
  <div id="guideContainer">
    <button id="closeGuide">X</button>
    <img id="guideImage" src="guide1.png" alt="èªªæ˜åœ–ç¤º">
    
  </div>
</div>

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
  </div>

  <div class="container">
    <div class="grid" id="grid"></div>

    <div class="controls">
      <button id="prevBtn" onclick="prevPage()">ä¸Šä¸€é </button>
      <button id="nextBtn" onclick="nextPage()">ä¸‹ä¸€é </button>
      <button id="undoBtn" onclick="undoLastStep()">å¾©åŸ</button>
      <button id="saveBtn" onclick="saveProgress()">å„²å­˜</button>
    </div>
  </div>
<script>
/* ===========================
   åŸºæœ¬è¨­å®š
=========================== */
const totalPages = 30;
const cellsPerPage = 10;

let currentUser = null;
let currentPage = 1;
let progress = {};
let historyStack = [];

/* ===========================
   ç™»å…¥ / è¨»å†Š
=========================== */
function submitAuth(mode) {
  const username = document.getElementById("authUsername").value.trim().toLowerCase();
  const password = document.getElementById("authPassword").value;

  if (!username || !password) {
    alert("è«‹è¼¸å…¥å¸³è™Ÿèˆ‡å¯†ç¢¼ï¼");
    return;
  }

  const storedPassword = localStorage.getItem(`password_${username}`);

  // ç™»å…¥
  if (mode === "login") {
    if (!storedPassword) return alert("ç„¡æ­¤å¸³è™Ÿç´€éŒ„");
    if (storedPassword !== password) return alert("å¯†ç¢¼éŒ¯èª¤");
  }

  // è¨»å†Š
  if (mode === "register") {
    if (storedPassword) return alert("æ­¤å¸³è™Ÿå·²å­˜åœ¨");

    localStorage.setItem(`password_${username}`, password);

    let displayName = "";
    let exists = true;

    while (exists) {
      displayName = prompt("è¨»å†ŠæˆåŠŸï¼è«‹è¼¸å…¥æ‚¨çš„ä½¿ç”¨è€…åç¨±ï¼š");
      if (!displayName) return alert("å¿…é ˆè¼¸å…¥ä½¿ç”¨è€…åç¨±ï¼è¨»å†Šçµ‚æ­¢");

      exists = false;
      for (let i = 0; i < localStorage.length; i++) {
        const k = localStorage.key(i);
        if (k.startsWith("displayName_") && localStorage.getItem(k) === displayName) {
          exists = true;
          alert("åç¨±å·²è¢«ä½¿ç”¨ï¼Œè«‹æ›ä¸€å€‹ï¼");
          break;
        }
      }
    }

    localStorage.setItem(`displayName_${username}`, displayName);
    alert("è¨»å†Šå®Œæˆä¸¦è‡ªå‹•ç™»å…¥ï¼");
  }

  loginUser(username);
}

/* ===========================
   ç™»å…¥å¾Œæµç¨‹
=========================== */
function loginUser(username) {
  currentUser = username;
  localStorage.setItem("currentUser", currentUser);

  const savedProgress = localStorage.getItem(`progress_${currentUser}`);
  const savedPage = localStorage.getItem(`page_${currentUser}`);

  progress = savedProgress ? JSON.parse(savedProgress) : {};
  currentPage = savedPage ? parseInt(savedPage) : 1;

  document.getElementById("authScreen").style.display = "none";
  renderPage();
}

/* ===========================
   ä¸»ç•«é¢æ¸²æŸ“
=========================== */
function renderPage() {
  const name = localStorage.getItem(`displayName_${currentUser}`) || currentUser;
  document.getElementById("displayName").textContent = name;
  document.getElementById("pageLabel").textContent = `${currentPage}-${totalPages}`;

  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  let allDone = true;
  let firstActive = false;

  for (let i = 0; i < cellsPerPage; i++) {
    const num = 5 + i;
    const key = `p${currentPage}-${num}`;

    const cell = document.createElement("div");
    cell.className = "cell";

    if (progress[key] === "done") {
      cell.classList.add("done");
      cell.textContent = "å·²å®Œæˆ";
    } else {
      cell.textContent = num;

      if (!firstActive) {
        firstActive = true;
        progress[key] = "active";
        cell.classList.add("active");
      }

      allDone = false;
    }

    cell.onclick = () => clickCell(key, num);
    grid.appendChild(cell);
  }

  document.getElementById("prevBtn").disabled = currentPage === 1;
  updateProgressBar();
  updateNextButton(allDone);

  localStorage.setItem(`progress_${currentUser}`, JSON.stringify(progress));
  localStorage.setItem(`page_${currentUser}`, currentPage);
}

/* ===========================
   é»æ“Šæ ¼å­
=========================== */
function clickCell(key, num) {
  if (progress[key] === "done") return;

  if (progress[key] !== "active")
    return alert("è«‹ä¾åºå®Œæˆï¼Œä¸èƒ½è·³éï¼");

  progress[key] = "done";
  historyStack.push(key);

  const nextKey = `p${currentPage}-${num + 1}`;
  if (!progress[nextKey]) progress[nextKey] = "active";

  renderPage();
}

/* ===========================
   ä¸‹ä¸€é  / ä¸Šä¸€é 
=========================== */
function nextPage() {
  for (let i = 0; i < cellsPerPage; i++) {
    const k = `p${currentPage}-${5 + i}`;
    if (progress[k] !== "done") return alert("è«‹å…ˆå®Œæˆæœ¬é ï¼");
  }

  if (currentPage < totalPages) {
    currentPage++;
    renderPage();
  }
}

function prevPage() {
  if (currentPage > 1) {
    currentPage--;
    renderPage();
  }
}

/* ===========================
   æŒ‰éˆ•ç‹€æ…‹
=========================== */
function updateNextButton(allDone) {
  const nextBtn = document.getElementById("nextBtn");

  if (currentPage === totalPages && allDone) {
    nextBtn.textContent = "å·²å®Œæˆ";
    nextBtn.onclick = () => alert("ğŸ‰ æ­å–œå®Œæˆæ‰€æœ‰ä»»å‹™ï¼");
    nextBtn.classList.add("completed");
    return;
  }

  nextBtn.textContent = "ä¸‹ä¸€é ";
  nextBtn.onclick = nextPage;

  if (allDone) {
    nextBtn.removeAttribute("disabled");
    nextBtn.classList.remove("disabled");
  } else {
    nextBtn.setAttribute("disabled", true);
    nextBtn.classList.add("disabled");
  }
}

/* ===========================
   é€²åº¦æ¢
=========================== */
function updateProgressBar() {
  const totalCells = totalPages * cellsPerPage;
  const doneCount = Object.values(progress).filter(v => v === "done").length;
  const percent = Math.round((doneCount / totalCells) * 100);
  document.getElementById("progressFill").style.width = `${percent}%`;
}

/* ===========================
   å„²å­˜ & å¾©åŸ
=========================== */
function saveProgress() {
  localStorage.setItem(`progress_${currentUser}`, JSON.stringify(progress));
  localStorage.setItem(`page_${currentUser}`, currentPage);

  alert("é€²åº¦å·²å„²å­˜ï¼");
}

function undoLastStep() {
  if (!historyStack.length) return;

  const lastKey = historyStack.pop();
  delete progress[lastKey];

  const m = lastKey.match(/p(\d+)-(\d+)/);
  if (m) {
    const page = parseInt(m[1]);
    const num = parseInt(m[2]);
    const nextKey = `p${page}-${num + 1}`;
    if (progress[nextKey] === "active") delete progress[nextKey];
  }

  renderPage();
}

/* ===========================
   ç™»å‡º / è¨»éŠ·
=========================== */
function logout() {
  localStorage.removeItem("currentUser");
  currentUser = null;

  document.getElementById("authScreen").style.display = "flex";
  document.getElementById("grid").innerHTML = "";
}

function deleteAccount() {
  if (!confirm("ç¢ºå®šè¦åˆªé™¤å¸³è™Ÿï¼Ÿ")) return;

  localStorage.removeItem(`password_${currentUser}`);
  localStorage.removeItem(`progress_${currentUser}`);
  localStorage.removeItem(`page_${currentUser}`);
  localStorage.removeItem(`displayName_${currentUser}`);
  localStorage.removeItem("currentUser");

  alert("å¸³è™Ÿå·²åˆªé™¤ï¼");
  location.reload();
}

/* ===========================
   åˆå§‹åŒ–ï¼šè‡ªå‹•ä¿æŒç™»å…¥
=========================== */
window.onload = () => {
  const savedUser = localStorage.getItem("currentUser");

  if (!savedUser) {
    document.getElementById("authScreen").style.display = "flex";
    return;
  }

  loginUser(savedUser);
};
</script>




</body>
</html>













































































